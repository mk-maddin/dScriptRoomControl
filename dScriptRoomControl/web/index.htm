<!DOCTYPE HTML>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>~System_HostName~</title>
    <link rel="stylesheet" type="text/css" href="dscript.css">
</head>

<body onload="startAJAX()">
    <h2 style="text-align:center" >Application page: ~System_HostName~<h3>

    <table align="center">
        <tr><td>Module:</td><td>~Module~</td></tr>
        <tr><td>App version:</td><td>~AppVerMajor~.~AppVerMinor~ (<a href="_config.htm">configure</a>)</td></tr>
        <tr><td>App message:</td><td><input id='Message' type="text" readonly="true" size="64"></td></tr>  
        <tr><td>App debug:</td><td><input id='Debug' type="text" readonly="true" size="64"></td></tr>
        <tr><td><button id='Srv' type="button" onmousedown="newAJAXCommand('dscript.cgi?App_WebInput=99');">contact Server</button></td><td>~App_dScriptServer~</td></tr> 
    </table>
    
    <hr>
    <p align="center"> Inputs: 
        <button id='Inp1' type="button" onmousedown="newAJAXCommand('dscript.cgi?App_WebInput=1');">1</button>
        <button id='Inp2' type="button" onmousedown="newAJAXCommand('dscript.cgi?App_WebInput=2');">2</button>
        <button id='Inp3' type="button" onmousedown="newAJAXCommand('dscript.cgi?App_WebInput=3');">3</button>
        <button id='Inp4' type="button" onmousedown="newAJAXCommand('dscript.cgi?App_WebInput=4');">4</button>
        <button id='Inp5' type="button" onmousedown="newAJAXCommand('dscript.cgi?App_WebInput=5');">5</button>
        <button id='Inp6' type="button" onmousedown="newAJAXCommand('dscript.cgi?App_WebInput=6');">6</button>
        <button id='Inp7' type="button" onmousedown="newAJAXCommand('dscript.cgi?App_WebInput=7');">7</button>
        <button id='Inp8' type="button" onmousedown="newAJAXCommand('dscript.cgi?App_WebInput=8');">8</button>
    </p>
    <p align="center"> Input type:<input id='InpType' type="text" readonly="true" size="64"></p>
    <p align="center"> Click Counts:<br>
        IC1 <input id='IC1' type="text" readonly="true" size="1">
        IC2 <input id='IC2' type="text" readonly="true" size="1">
        IC3 <input id='IC3' type="text" readonly="true" size="1">
        IC4 <input id='IC4' type="text" readonly="true" size="1"><br>
        IC5 <input id='IC5' type="text" readonly="true" size="1">
        IC6 <input id='IC6' type="text" readonly="true" size="1">
        IC7 <input id='IC7' type="text" readonly="true" size="1">
        IC8 <input id='IC8' type="text" readonly="true" size="1">
    </p>
    
    <hr>
    <p  align="center"> Shutters:
        <table align="center">
            <tr>
                <td id="tdSH1">S01 <progress id='SH1' value="0" max="100"></progress></td>
                <td id="tdSH2">S02 <progress id='SH2' value="0" max="100"></progress></td>
                <td id="tdSH3">S03 <progress id='SH3' value="0" max="100"></progress></td>
                <td id="tdSH4">S04 <progress id='SH4' value="0" max="100"></progress></td>
            </tr><tr>
                <td id="tdSH5">S05 <progress id='SH5' value="0" max="100"></progress></td>
                <td id="tdSH6">S06 <progress id='SH6' value="0" max="100"></progress></td>
                <td id="tdSH7">S07 <progress id='SH7' value="0" max="100"></progress></td>
                <td id="tdSH8">S08 <progress id='SH8' value="0" max="100"></progress></td>
            </tr><tr>
                <td id="tdSH9">S09 <progress id='SH9' value="0" max="100"></progress></td>
                <td id="tdSH10">S10 <progress id='SH10' value="0" max="100"></progress></td>
                <td id="tdSH11">S11 <progress id='SH11' value="0" max="100"></progress></td>
                <td id="tdSH12">S12 <progress id='SH12' value="0" max="100"></progress></td>
            </tr><tr>
                <td id="tdSH13">S13 <progress id='SH13' value="0" max="100"></progress></td>
                <td id="tdSH14">S14 <progress id='SH14' value="0" max="100"></progress></td>
                <td id="tdSH15">S15 <progress id='SH15' value="0" max="100"></progress></td>
                <td id="tdSH16">S16 <progress id='SH16' value="0" max="100"></progress></td>
            </tr>
        </table>
    </p>

    <hr>
    <p  align="center"> Relays:
<!--        <table align="center">
            <tr><td>cmdIO:</td><td><input id='cmdIO' type="text" readonly="true" size="2"></td></tr>  
            <tr><td>RlyState:</td><td><input id='RlyState' type="text" readonly="true" size="2"></td></tr>
        </table> --> 
        <table align="center">
            <tr>
                <td>R01  <img class='IO' id='R1' src='RedOff.png'/></td>
                <td>R02  <img class='IO' id='R2' src='RedOff.png'/></td>
                <td>R03  <img class='IO' id='R3' src='RedOff.png'/></td>
                <td>R04  <img class='IO' id='R4' src='RedOff.png'/></td>
            </tr><tr>
                <td>R05  <img class='IO' id='R5' src='RedOff.png'/></td>
                <td>R06  <img class='IO' id='R6' src='RedOff.png'/></td>
                <td>R07  <img class='IO' id='R7' src='RedOff.png'/></td>
                <td>R08  <img class='IO' id='R8' src='RedOff.png'/></td>
            </tr><tr>
                <td>R09  <img class='IO' id='R9' src='RedOff.png'/></td>
                <td>R10 <img class='IO' id='R10' src='RedOff.png'/></td>
                <td>R11 <img class='IO' id='R11' src='RedOff.png'/></td>
                <td>R12 <img class='IO' id='R12' src='RedOff.png'/></td>
            </tr><tr>
                <td>R13 <img class='IO' id='R13' src='RedOff.png'/></td>
                <td>R14 <img class='IO' id='R14' src='RedOff.png'/></td>
                <td>R15 <img class='IO' id='R15' src='RedOff.png'/></td>
                <td>R16 <img class='IO' id='R16' src='RedOff.png'/></td>
            </tr><tr>
                <td>R17 <img class='IO' id='R17' src='RedOff.png'/></td>
                <td>R18 <img class='IO' id='R18' src='RedOff.png'/></td>
                <td>R19 <img class='IO' id='R19' src='RedOff.png'/></td>
                <td>R20 <img class='IO' id='R20' src='RedOff.png'/></td>
            </tr><tr>
                <td>R21 <img class='IO' id='R21' src='RedOff.png'/></td>
                <td>R22 <img class='IO' id='R22' src='RedOff.png'/></td>
                <td>R23 <img class='IO' id='R23' src='RedOff.png'/></td>
                <td>R24 <img class='IO' id='R24' src='RedOff.png'/></td>
            </tr><tr>
                <td>R25 <img class='IO' id='R25' src='RedOff.png'/></td>
                <td>R26 <img class='IO' id='R26' src='RedOff.png'/></td>
                <td>R27 <img class='IO' id='R27' src='RedOff.png'/></td>
                <td>R28 <img class='IO' id='R28' src='RedOff.png'/></td>
            </tr><tr>
                <td>R29 <img class='IO' id='R29' src='RedOff.png'/></td>
                <td>R30 <img class='IO' id='R30' src='RedOff.png'/></td>
                <td>R31 <img class='IO' id='R31' src='RedOff.png'/></td>
                <td>R32 <img class='IO' id='R32' src='RedOff.png'/></td>
            </tr>
        </table>
    </p>

<script type="text/javascript">

IOViews();
ShutterViews();

function ajaxUpdate()
{
    var msg = getValue('App_Message');
    if (msg != document.getElementById('Message').value){
        console.log("App_Message: " + getValue('App_Message'));}
    document.getElementById('Message').value = getValue('App_Message');
    document.getElementById('Debug').value = getValue('App_Debug');
    

    document.getElementById('InpType').value = getValue('App_InpType');
    document.getElementById('IC1').value = getValue('App_IOCtr1');
    document.getElementById('IC2').value = getValue('App_IOCtr2');
    document.getElementById('IC3').value = getValue('App_IOCtr3');
    document.getElementById('IC4').value = getValue('App_IOCtr4');
    document.getElementById('IC5').value = getValue('App_IOCtr5');
    document.getElementById('IC6').value = getValue('App_IOCtr6');
    document.getElementById('IC7').value = getValue('App_IOCtr7');
    document.getElementById('IC8').value = getValue('App_IOCtr8');

    document.getElementById('SH1').value = 100 - getValue('App_ShutterLevel1');
    document.getElementById('SH2').value = 100 - getValue('App_ShutterLevel2');
    document.getElementById('SH3').value = 100 - getValue('App_ShutterLevel3');
    document.getElementById('SH4').value = 100 - getValue('App_ShutterLevel4');
    document.getElementById('SH5').value = 100 - getValue('App_ShutterLevel5');
    document.getElementById('SH6').value = 100 - getValue('App_ShutterLevel6');
    document.getElementById('SH7').value = 100 - getValue('App_ShutterLevel7');
    document.getElementById('SH8').value = 100 - getValue('App_ShutterLevel8');
    document.getElementById('SH9').value = 100 - getValue('App_ShutterLevel9');
    document.getElementById('SH10').value = 100 - getValue('App_ShutterLevel10');
    document.getElementById('SH11').value = 100 - getValue('App_ShutterLevel11');
    document.getElementById('SH12').value = 100 - getValue('App_ShutterLevel12');
    document.getElementById('SH13').value = 100 - getValue('App_ShutterLevel13');
    document.getElementById('SH14').value = 100 - getValue('App_ShutterLevel14');
    document.getElementById('SH15').value = 100 - getValue('App_ShutterLevel15');
    document.getElementById('SH16').value = 100 - getValue('App_ShutterLevel16');

//    document.getElementById('cmdIO').value = getValue('cmdIO');
//    document.getElementById('RlyState').value = getValue('RlyState');
    document.getElementById('R1').src = (getValue('Rly1')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R2').src = (getValue('Rly2')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R3').src = (getValue('Rly3')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R4').src = (getValue('Rly4')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R5').src = (getValue('Rly5')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R6').src = (getValue('Rly6')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R7').src = (getValue('Rly7')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R8').src = (getValue('Rly8')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R9').src = (getValue('Rly9')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R10').src = (getValue('Rly10')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R11').src = (getValue('Rly11')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R12').src = (getValue('Rly12')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R13').src = (getValue('Rly13')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R14').src = (getValue('Rly14')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R15').src = (getValue('Rly15')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R16').src = (getValue('Rly16')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R17').src = (getValue('Rly17')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R18').src = (getValue('Rly18')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R19').src = (getValue('Rly19')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R20').src = (getValue('Rly20')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R21').src = (getValue('Rly21')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R22').src = (getValue('Rly22')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R23').src = (getValue('Rly23')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R24').src = (getValue('Rly24')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R25').src = (getValue('Rly25')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R26').src = (getValue('Rly26')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R27').src = (getValue('Rly27')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R28').src = (getValue('Rly28')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R29').src = (getValue('Rly29')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R30').src = (getValue('Rly30')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R31').src = (getValue('Rly31')=='1') ? 'RedOn.png' : 'DarkOff.png';
    document.getElementById('R32').src = (getValue('Rly32')=='1') ? 'RedOn.png' : 'DarkOff.png';
}


function IOViews() {
    for (x = 1; x <= 8; x++) {   
        switch(x){
            case 1: t=~App_IOType1~;break;
            case 2: t=~App_IOType2~;break;
            case 3: t=~App_IOType3~;break;
            case 4: t=~App_IOType4~;break;
            case 5: t=~App_IOType5~;break;
            case 6: t=~App_IOType6~;break;
            case 7: t=~App_IOType7~;break;
            case 8: t=~App_IOType8~;break;
            default: t=0;
        }
        if(t == 4){document.getElementById('Inp'+x).style.visibility  = 'hidden';
            document.getElementById('IC'+x).disabled = true;            
        } else {
            document.getElementById('Inp'+x).style.visibility  = 'visible';
            document.getElementById('IC'+x).disabled = false;}
    }
}

function ShutterViews() {
    for (x = 1; x <= 16; x++) {   
        if(x > ~App_Shutters~){document.getElementById('tdSH'+x).style.visibility  = 'hidden';          
        } else {
            document.getElementById('tdSH'+x).style.visibility  = 'visible';
        }
    }
}

</script>

</body>
</html>